---
title: 'Intro to R: Day 2 Part 1'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data frame manipulation with dplyr
<https://swcarpentry.github.io/r-novice-gapminder/13-dplyr/index.html>

### Summary statistics using **base R** operations  

```{r}
gapminder <- read.csv("data/gapminder_data.csv", stringsAsFactors = TRUE)
mean(gapminder[gapminder$continent == "Africa", "gdpPercap"]) 
```


```{r}
gapminder <- read.csv("data/gapminder_data.csv", stringsAsFactors = TRUE)
mean(gapminder[gapminder$continent == "Americas", "gdpPercap"])
```

## the **dplyr** package

###The five most commonly used functions, and **%>%**    

* select() 
* filter() 
* groub_by() 
* summarize() 
* mutate() 

### Installing dplyr package  
```
install.packages('dplyr')   note: does ' or " matter 
```

### Loading the package  
```
library("dplyr")
```

### The select() function 

![](images/13-dplyr-fig1.png)

Select columns: 

```
head(select(gapminder, year, country, gdpPercap))
```

Select columns and save to a new dataframe   

```
year_country_gdp <- select(gapminder, year, country, gdpPercap)
```

### Removing a column

```
smaller_gapminder_data <- select(gapminder, -continent)
```

### Removing a column using **dplyr** and **pipes (%>%)**  
```
year_country_gdp <- gapminder %>% select(year, country, gdpPercap)
```

### Renaming columns in a dataframe 

Syntax: **rename(new_name = old_name)**  

```
tidy_gdp <- year_country_gdp %>% rename(gdp_per_capita = gdpPercap)
```  

### Using the filter() function

As the name suggests, filter out everything but the data you want.  

Using filter combined with select:  
```
year_country_gdp_euro <- gapminder %>% 
  filter(continent == "Europe") %<% 
  select(year, country, gdpPercap) 
```

Adding a filter for specific year: 
```
year_country_gdp_euro <- gapminder %>% 
  filter(continent == "Europe", year == 2007) %<% 
  select(year, country, gdpPercap) 
```
### Challenge 1  

Write a single command (which can span multiple lines and includes pipes) that will produce a dataframe that has the **African** values for **lifeExp**, **country** and **year**, but not for the other Continents.
How many rows does your data frame have, and why?


### Using the group_by function  

Avoid error-prone repetitiveness. Rather then cutting and pasting the above code for each continent use the group_by function.

```
gapminder %>% group_by(continent)

str(gapminder %>% group_by(continent)) 
```

## Using the summarize function  

*group_by* is often used in conunction with *summarize()*

- first split the data frame into multiple pieces with *group_by()*   
- then pipe that data into other functions such as *mean()* or *sd()* within *summarize()*  

``` 
gdp_bycontinents <- gapminder %>% 
  group_by(continent) %>% 
  summarize(mean_gdpPercap = mean(gdpPercap))
```

### Challenge 2  
- Calculate the average life expectancy per country. 
- Which has the longest average life expectancy and which has the shortest average life expectancy?  


_ 
- 